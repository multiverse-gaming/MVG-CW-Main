AddCSLuaFile() local dashvelocity=1 local dashmidair=true local dashupdash=true local airdashlimit=0 local airdashcounter=0 local dashtimer=0 local dashdelay=0.5 local dash_doarmanim = CreateConVar( "cl_dash_armanim", 1, { FCVAR_ARCHIVE }, "Toggle arm animations" ) concommand.Add( "dash", function(ply,cmd, args) local activewep=ply:GetActiveWeapon() if IsValid(ArmAnim) or !IsValid(activewep) or IsValid(VMGesture) or dashtimer>=CurTime()then return end local movingleft=ply:KeyDown(IN_MOVELEFT) local movingright=ply:KeyDown(IN_MOVERIGHT) local movingforward=ply:KeyDown(IN_FORWARD) local movingback=ply:KeyDown(IN_BACK) local onground=ply:OnGround() local doarmanim=dash_doarmanim:GetBool() local animtoplay="dashleft" local endtime=0.25 if (movingright and movingleft and !movingforward and !movingback) or (!movingright and !movingleft and !movingforward and !movingback) then return end if !onground and (!dashmidair and ((movingright or movingleft or movingback) and !movingforward)) then return end if !onground and !dashmidair and !dashupdash then return end if !onground then airdashcounter=airdashcounter+1 end if !onground and airdashcounter>airdashlimit and airdashlimit!=0 then return end if movingleft then 	 	net.Start("PA_Dash") net.WriteInt(1,32) net.SendToServer() 	animtoplay="dashleft" endtime=0.25 	 elseif movingright then 	 	net.Start("PA_Dash") net.WriteInt(2,32) net.SendToServer() 	animtoplay="dashright" endtime=0.25 elseif movingforward and (onground or (!dashupdash or ply:KeyDown(IN_SPEED))) then 	 	net.Start("PA_Dash") net.WriteInt(3,32) net.SendToServer() 	animtoplay="dashforward" endtime=2 	 elseif movingforward and !onground and dashupdash then 	 	net.Start("PA_Dash") net.WriteInt(5,32) net.SendToServer() 	animtoplay="flyup" endtime=0.25 elseif movingback then 	 	net.Start("PA_Dash") net.WriteInt(4,32) net.SendToServer() 	animtoplay="dashback" endtime=2 end if doarmanim then StartArmAnim(animtoplay,"c_miscarm",endtime) end ply:EmitSound("dashwhoosh.wav",50,math.random(75,125),0.4) if onground then ply:EmitSound("meslide"..tostring(math.random(1,2))..".wav",50,math.random(75,125),0.55) end dashtimer=CurTime()+dashdelay end) hook.Add("PlayerFootstep","PA_DashFootsteps",function(ply,pos,foot,sound) if IsValid(ArmAnim) and string.find(ArmAnimString,"dash") then return true end end) hook.Add("Think","PA_DashThink",function() if LocalPlayer():OnGround() and airdashcounter!=0 then airdashcounter=0 end end) net.Receive("PA_DashUpdateCLVars",function(len) 	dashvelocity=net.ReadFloat() 	dashmidair=net.ReadBool() 	dashupdash=net.ReadBool() 	airdashlimit=net.ReadInt(32) 	dashdelay=net.ReadFloat() end)