
local Category = "FMod Specials"
sound.Add( {
	name = "FMod_FollowMe.CitizenMale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/leadtheway01.wav", 
	"vo/npc/male01/leadtheway02.wav", 
	"vo/npc/male01/letsgo01.wav", 
	"vo/npc/male01/letsgo02.wav", 
	"vo/npc/male01/ok01.wav", 
	"vo/npc/male01/ok02.wav", 
	"vo/npc/male01/okimready01.wav", 
	"vo/npc/male01/okimready02.wav", 
	"vo/npc/male01/okimready03.wav", 
	"vo/npc/male01/squad_follow02.wav", 
	"vo/npc/male01/squad_follow03.wav", 
	}
} )

sound.Add( {
	name = "FMod_Copy.CitizenMale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/ok01.wav", 
	"vo/npc/male01/ok02.wav",
	"vo/npc/male01/squad_approach04.wav",
	"vo/npc/male01/yeah02.wav",
	"vo/npc/male01/yougotit02.wav",
	"vo/npc/male01/squad_affirm03.wav", 
	"vo/npc/male01/squad_affirm04.wav",
	"vo/npc/male01/squad_affirm05.wav",
	"vo/npc/male01/squad_affirm06.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.CitizenMale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/holddownspot01.wav",
	"vo/npc/male01/holddownspot02.wav",
	"vo/npc/male01/imstickinghere01.wav",
	"vo/npc/male01/littlecorner01.wav",
	"vo/npc/male01/yougotit02.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.CitizenFemale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/female01/leadtheway01.wav",
	"vo/npc/female01/leadtheway02.wav",
	"vo/npc/female01/letsgo01.wav",
	"vo/npc/female01/letsgo02.wav",
	"vo/npc/female01/okimready01.wav",
	"vo/npc/female01/okimready02.wav",
	"vo/npc/female01/okimready03.wav",
	"vo/npc/female01/readywhenyouare01.wav",
	"vo/npc/female01/readywhenyouare02.wav",
	"vo/npc/female01/squad_follow03.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.CitizenFemale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/female01/ok01.wav",
	"vo/npc/female01/ok02.wav",
	"vo/npc/female01/squad_approach04.wav",
	"vo/npc/female01/yeah02.wav",
	"vo/npc/female01/yougotit02.wav",
	"vo/npc/female01/squad_affirm03.wav",
	"vo/npc/female01/squad_affirm04.wav",
	"vo/npc/female01/squad_affirm05.wav",
	"vo/npc/female01/squad_affirm06.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.CitizenFemale",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/female01/holddownspot01.wav",
	"vo/npc/female01/holddownspot02.wav",
	"vo/npc/female01/illstayhere01.wav",
	"vo/npc/female01/imstickinghere01.wav",
	"vo/npc/female01/littlecorner01.wav",
	"vo/npc/female01/yougotit02.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Alyx",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/alyx/al_car_getgoing02.wav",
	"vo/npc/alyx/al_car_getgoing04.wav",
	"vo/npc/alyx/al_car_callback03.wav",
	"vo/npc/alyx/al_car_callback02.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.Alyx",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/alyx/al_car_laughing06.wav",
	"vo/npc/alyx/al_car_laughing08.wav",
	"vo/npc/alyx/al_car_laughing10.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.Alyx",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/alyx/al_car_stayincar01.wav",
	"vo/npc/alyx/al_car_stayincar02.wav",
	"vo/npc/alyx/al_car_stayincar03.wav",
	"vo/npc/alyx/al_car_stayincar04.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Barney",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/barney/ba_bringiton.wav",
	"vo/npc/barney/ba_followme02.wav",
	"vo/npc/barney/ba_imwithyou.wav",
	"vo/npc/barney/ba_letsdoit.wav",
	"vo/npc/barney/ba_letsgo.wav",
	"vo/npc/barney/ba_hurryup.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.Barney",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/barney/ba_yell.wav",
	"vo/npc/barney/ba_getoutofway.wav",
	"vo/npc/barney/ba_getaway.wav",
	"vo/npc/barney/ba_covermegord.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.Barney",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/barney/ba_damnit.wav",
	"vo/npc/barney/ba_danger02.wav",
	"vo/npc/barney/ba_oldtimes.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Vort",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/vortigaunt/accompany.wav",
	"vo/npc/vortigaunt/beofservice.wav",
	"vo/npc/vortigaunt/bodyyours.wav",
	"vo/npc/vortigaunt/dedicate.wav",
	"vo/npc/vortigaunt/dreamed.wav",
	"vo/npc/vortigaunt/empowerus.wav",
	"vo/npc/vortigaunt/itishonor.wav",
	"vo/npc/vortigaunt/leadon.wav",
	"vo/npc/vortigaunt/leadus.wav",
	"vo/npc/vortigaunt/livetoserve.wav",
	"vo/npc/vortigaunt/pleasure.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.Vort",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/vortigaunt/affirmed.wav",
	"vo/npc/vortigaunt/asyouwish.wav",
	"vo/npc/vortigaunt/here.wav",
	"vo/npc/vortigaunt/done.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.Vort",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/vortigaunt/halt.wav",
	"vo/npc/vortigaunt/herewestay.wav",
	"vo/npc/vortigaunt/hold.wav",
	"vo/npc/vortigaunt/onward.wav",
	"vo/npc/vortigaunt/ourplacehere.wav",
	"vo/npc/vortigaunt/passon.wav",
	"vo/npc/vortigaunt/reasondelay.wav",
	"vo/npc/vortigaunt/servebetterhere.wav",
	"vo/npc/vortigaunt/standclear.wav",
	"vo/npc/vortigaunt/stillhere.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.CombineSoldier",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/combine_soldier/vo/affirmative.wav",
	"npc/combine_soldier/vo/affirmative2.wav",
	"npc/combine_soldier/vo/closing.wav",
	"npc/combine_soldier/vo/closing2.wav",
	"npc/combine_soldier/vo/unitisclosing.wav",
	"npc/combine_soldier/vo/unitismovingin.wav",
	"npc/combine_soldier/vo/copy.wav",
	"npc/combine_soldier/vo/copythat.wav",
	"npc/combine_soldier/vo/movein.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.CombineSoldier",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/combine_soldier/vo/copy.wav",
	"npc/combine_soldier/vo/copythat.wav",
	"npc/combine_soldier/vo/movein.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.CombineSoldier",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/combine_soldier/vo/contained.wav",
	"npc/combine_soldier/vo/displace.wav",
	"npc/combine_soldier/vo/fullactive.wav",
	"npc/combine_soldier/vo/hardenthatposition.wav",
	"npc/combine_soldier/vo/stabilizationteamholding.wav",
	"npc/combine_soldier/vo/stabilizationteamhassector.wav",
	"npc/combine_soldier/vo/stayalert.wav",
	"npc/combine_soldier/vo/stayalertreportsightlines.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Metropolice",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/metropolice/vo/affirmative.wav",
	"npc/metropolice/vo/affirmative2.wav",
	"npc/metropolice/vo/converging.wav",
	"npc/metropolice/vo/copy.wav",
	"npc/metropolice/vo/keepmoving.wav",
	"npc/metropolice/vo/move.wav",
	"npc/metropolice/vo/movealong.wav",
	"npc/metropolice/vo/movealong3.wav",
	"npc/metropolice/vo/moveit.wav",
	"npc/metropolice/vo/moveit2.wav",
	"npc/metropolice/vo/rodgerthat.wav",
	}
} )

sound.Add( {
	name = "FMod_Copy.Metropolice",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/metropolice/vo/affirmative.wav",
	"npc/metropolice/vo/copy.wav",
	"npc/metropolice/vo/rodgerthat.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.Metropolice",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/metropolice/vo/dontmove.wav",
	"npc/metropolice/vo/lockyourposition.wav",
	"npc/metropolice/vo/patrol.wav",
	"npc/metropolice/vo/inposition.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Other",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { "buttons/button17.wav" }
} )

sound.Add( {
	name = "FMod_Copy.Other",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { "buttons/button19.wav" }
} )

sound.Add( {
	name = "FMod_StayHere.Other",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { "buttons/button18.wav" }
} )

sound.Add( {
	name = "FMod_Huntey.Down",
	channel = CHAN_ITEM,
	volume = 0.8,
	level = 60,
	pitch = 100,
	sound = { "npc/ministrider/ministrider_skewer1.wav" }
} )

sound.Add( {
	name = "FMod_Special.LightOn",
	channel = CHAN_ITEM,
	volume = 0.8,
	level = 60,
	pitch = 140,
	sound = { "buttons/combine_button5.wav" }
} )

sound.Add( {
	name = "FMod_Special.LightOff",
	channel = CHAN_ITEM,
	volume = 0.8,
	level = 60,
	pitch = 140,
	sound = { "buttons/combine_button3.wav" }
} )

sound.Add( {
	name = "FMod_Huntey.Help",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/ministrider/hunter_defendstrider1.wav",
	"npc/ministrider/hunter_defendstrider2.wav",
	"npc/ministrider/hunter_defendstrider3.wav",
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Huntey",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/ministrider/hunter_foundenemy_ack1.wav",
	"npc/ministrider/hunter_foundenemy_ack2.wav",
	"npc/ministrider/hunter_foundenemy_ack3.wav"
	}
} )

sound.Add( {
	name = "FMod_Copy.Huntey",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/ministrider/hunter_foundenemy3.wav",
	}
} )

sound.Add( {
	name = "FMod_StayHere.Huntey",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/ministrider/hunter_foundenemy1.wav",
	"npc/ministrider/hunter_foundenemy2.wav"
	}
} )

sound.Add( {
	name = "FMod_Huntey.Wake",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"npc/ministrider/hunter_laugh1.wav",
	"npc/ministrider/hunter_laugh2.wav",
	"npc/ministrider/hunter_laugh3.wav",
	"npc/ministrider/hunter_laugh4.wav",
	"npc/ministrider/hunter_laugh5.wav",
	}
} )

sound.Add( {
	name = "FMod_HunteyJump.On",
	channel = CHAN_ITEM,
	volume = 0.8,
	level = 70,
	pitch = 110,
	sound = { 
	"weapons/rpg/rocketfire1.wav"
	}
} )

sound.Add( {
	name = "FMod_HunteyJump.Active",
	channel = CHAN_ITEM,
	volume = 0.9,
	level = 70,
	pitch = 75,
	sound = { 
	"weapons/rpg/rocket1.wav"
	}
} )

sound.Add( {
	name = "FMod_Down.Delta",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/pain01.wav",
	"vo/npc/male01/pain02.wav",
	"vo/npc/male01/pain03.wav",
	"vo/npc/male01/pain04.wav",
	"vo/npc/male01/pain05.wav",
	"vo/npc/male01/pain06.wav",
	"vo/npc/male01/pain07.wav",
	"vo/npc/male01/pain08.wav",
	"vo/npc/male01/pain09.wav",
	"vo/npc/male01/hitingut01.wav",
	"vo/npc/male01/hitingut02.wav",
	}
} )

sound.Add( {
	name = "FMod_Help.Delta",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/moan01.wav",
	"vo/npc/male01/moan02.wav",
	"vo/npc/male01/moan03.wav",
	"vo/npc/male01/moan04.wav",
	"vo/npc/male01/moan05.wav",
	"vo/npc/male01/help01.wav",
	"vo/npc/male01/no01.wav",
	"vo/npc/male01/mygut02.wav",
	}
} )

sound.Add( {
	name = "FMod_Wake.Delta",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/finally.wav",
	"vo/npc/male01/vquestion04.wav",
	"vo/npc/male01/vquestion02.wav",
	"vo/npc/male01/question15.wav",
	"vo/npc/male01/question05.wav",
	}
} )

sound.Add( {
	name = "FMod_Medkit.Delta",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"vo/npc/male01/health01.wav",
	"vo/npc/male01/health02.wav",
	"vo/npc/male01/health03.wav",
	"vo/npc/male01/health04.wav",
	"vo/npc/male01/health05.wav"
	}
} )

sound.Add( {
	name = "FMod_Jump.Other",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 70,
	pitch = 100,
	sound = {
	"npc/combine_soldier/zipline_hitground1.wav",
	"npc/combine_soldier/zipline_hitground2.wav"
	}
} )

sound.Add( {
	name = "FMod_Land.Other",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 70,
	pitch = 100,
	sound = {
	"npc/combine_soldier/gear1.wav",
	"npc/combine_soldier/gear2.wav",
	"npc/combine_soldier/gear3.wav",
	"npc/combine_soldier/gear4.wav",
	"npc/combine_soldier/gear5.wav",
	"npc/combine_soldier/gear6.wav"
	}
} )

sound.Add( {
	name = "FMod_MeleeHit.Weapon",
	channel = CHAN_AUTO,
	volume = 0.9,
	level = 65,
	pitch = { 90, 110 },
	sound = { 
	"physics/metal/weapon_impact_hard1.wav",
	"physics/metal/weapon_impact_hard2.wav",
	"physics/metal/weapon_impact_hard3.wav"
	}
} )

sound.Add( {
	name = "FMod_MeleeMiss.Weapon",
	channel = CHAN_AUTO,
	volume = 0.9,
	level = 65,
	pitch = { 90, 110 },
	sound = { 
	"physics/metal/weapon_impact_soft1.wav",
	"physics/metal/weapon_impact_soft2.wav",
	"physics/metal/weapon_impact_soft3.wav"
	}
} )

sound.Add( {
	name = "FMod_MeleeHit.Hand",
	channel = CHAN_AUTO,
	volume = 0.9,
	level = 65,
	pitch = { 90, 110 },
	sound = { 
	"physics/body/body_medium_impact_hard1.wav",
	"physics/body/body_medium_impact_hard2.wav",
	"physics/body/body_medium_impact_hard3.wav",
	"physics/body/body_medium_impact_hard4.wav",
	"physics/body/body_medium_impact_hard5.wav",
	"physics/body/body_medium_impact_hard6.wav"
	}
} )

sound.Add( {
	name = "FMod_MeleeMiss.Hand",
	channel = CHAN_AUTO,
	volume = 0.9,
	level = 65,
	pitch = { 90, 110 },
	sound = {"weapons/iceaxe/iceaxe_swing1.wav"}
} )

sound.Add( {
	name = "FMod_Heal.NPC",
	channel = CHAN_ITEM,
	volume = 0.9,
	level = 65,
	pitch = 100,
	sound = {"items/medshot4.wav"}
} )

sound.Add( {
	name = "FMod_Radio.On",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 100,
	pitch = 100,
	sound = {"npc/metropolice/vo/on1.wav"}
} )

sound.Add( {
	name = "FMod_Radio.Off",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 100,
	pitch = 100,
	sound = {"npc/metropolice/vo/off1.wav"}
} )

sound.Add( {
	name = "FMod_Down.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo8.wav"
	}
} )

sound.Add( {
	name = "FMod_Help.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo7.wav",
	"fmod_steve_the_bandit/steve_heyo9.wav"
	}
} )

sound.Add( {
	name = "FMod_Wake.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo2.wav"
	}
} )

sound.Add( {
	name = "FMod_FollowMe.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo1.wav"
	}
} )

sound.Add( {
	name = "FMod_Copy.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo3.wav"
	}
} )

sound.Add( {
	name = "FMod_StayHere.Stevetb",
	channel = CHAN_VOICE,
	volume = VOL_NORM,
	level = SNDLVL_80dB,
	pitch = PITCH_NORM,
	sound = { 
	"fmod_steve_the_bandit/steve_heyo4.wav",
	"fmod_steve_the_bandit/steve_heyo5.wav"
	}
} )

sound.Add( {
	name = "FMod_SeatStand.Effect",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 70,
	pitch = { 110, 130 },
	sound = {
	"npc/metropolice/gear1.wav",
	"npc/metropolice/gear2.wav",
	"npc/metropolice/gear3.wav",
	"npc/metropolice/gear4.wav",
	"npc/metropolice/gear5.wav",
	"npc/metropolice/gear6.wav"
	}
} )

sound.Add( {
	name = "FMod_Seat.Enter",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 70,
	pitch = { 60, 75 },
	sound = {"items/ammocrate_open.wav"}
} )

sound.Add( {
	name = "FMod_Seat.Exit",
	channel = CHAN_ITEM,
	volume = 1.0,
	level = 70,
	pitch = { 60, 75 },
	sound = {"items/ammocrate_close.wav"}
} )

if !ConVarExists("fmod_enable") then
   CreateConVar("fmod_enable", '1', (FCVAR_ARCHIVE), "Enable or Disable followers mod.", 0, 1)
end
if !ConVarExists("fmod_min_call_dist") then
   CreateConVar("fmod_min_call_dist", '80', (FCVAR_ARCHIVE), "Minimal distance to call for follower.", 0, 9999)
end
if !ConVarExists("fmod_min_spot_dist") then
   CreateConVar("fmod_min_spot_dist", '2000', (FCVAR_ARCHIVE), "Minimal distance to spot enemies for your followers.", 0, -1)
end
--
if !ConVarExists("fmod_allow_collisions") then
   CreateConVar("fmod_allow_collisions", '1', (FCVAR_ARCHIVE), "If 0, following you NPCs will not collide with you.", 0, 1)
end
--
if !ConVarExists("fmod_allow_ff") then
   CreateConVar("fmod_allow_ff", '1', (FCVAR_ARCHIVE), "If 1, it will prevent the friendly fire.", 0, 1)
end
if !ConVarExists("fmod_buff_damage") then
   CreateConVar("fmod_buff_damage", '0', (FCVAR_ARCHIVE), "Set damage of your followers.", 0, 1)
end
if !ConVarExists("fmod_buff_resistance") then
   CreateConVar("fmod_buff_resistance", '0', (FCVAR_ARCHIVE), "Set resistance of your followers.", 0, -1)
end
if !ConVarExists("fmod_buff_proficiency") then
   CreateConVar("fmod_buff_proficiency", '2', (FCVAR_ARCHIVE), "Set weapon proficiency of your followers.", 0, 10)
end
if !ConVarExists("fmod_followers_speak") then
   CreateConVar("fmod_followers_speak", '0', (FCVAR_ARCHIVE), "If 1, followers will tell you if they will follow you or stay at thier positions.", 0, 1)
end
if !ConVarExists("fmod_auto_teleport") then
   CreateConVar("fmod_auto_teleport", '1', (FCVAR_ARCHIVE), "If your followers can't reach you, they will teleport at your position (behind you).", 0, 1)
end
if !ConVarExists("fmod_followers_enter_vehicles") then
   CreateConVar("fmod_followers_enter_vehicles", '1', (FCVAR_ARCHIVE), "Allow Your followers to enter vehicles.", 0, 1)
end
if !ConVarExists("fmod_vehicle_max_dist") then
   CreateConVar("fmod_vehicle_max_dist", '120', (FCVAR_ARCHIVE), "How close Your followers has to be to enter a vehicle/seat.", 0, -1)
end
--[[
if !ConVarExists("fmod_followers_special_mortal") then
   CreateConVar("fmod_followers_special_mortal", '0', (FCVAR_ARCHIVE), "If enabled, few of the specials could be killed.", 0, 1)
end]]--

hook.Add("OnEntityCreated", "FMOD_GiveWeapons", function(ent)
ent:SetNWString("FiLzO_WeaponType", GetConVarString("gmod_npcweapon"))
end)

if(CLIENT)then
--[[
if !ConVarExists("fmod_halo") then	
   CreateClientConVar("fmod_halo", '1', (FCVAR_ARCHIVE), "Enable halo effect that will appear on following you NPCs.", true, true)
end
if !ConVarExists("fmod_halocolor_r") then	
   CreateClientConVar("fmod_halocolor_r", '0', (FCVAR_ARCHIVE), "Followers mod halo color red.", true, true)
end
if !ConVarExists("fmod_halocolor_g") then	
   CreateClientConVar("fmod_halocolor_g", '200', (FCVAR_ARCHIVE), "Followers mod halo color green.", true, true)
end
if !ConVarExists("fmod_halocolor_b") then	
   CreateClientConVar("fmod_halocolor_b", '0', (FCVAR_ARCHIVE), "Followers mod halo color blue.", true, true)
end
--]]
	if !ConVarExists("fmod_chat_support") then	
	   CreateClientConVar("fmod_chat_support", '1', (FCVAR_ARCHIVE), "Enable additional informations in chat.", 0, 1)
	end

--[[ -- Seems to be a hook designed for the "special" npc's to talk to you.
	local function FMOD_RadioTalker(data)
		local Sound = data:ReadString()
		local Entity = data:ReadEntity()
		local Level = data:ReadFloat()
		local Pitch = data:ReadFloat()
		local Volume = data:ReadFloat()
		if Entity:GetNWBool("FMOD_AllowRadio") and (!Entity:GetNWBool("FMOD_RadioPlaySound")) then
			Entity.radiom = CreateSound(Entity, Sound)
			Entity.radiom:SetDSP(38)
			Entity.radiom:Play()
			Entity:SetNWBool("FMOD_RadioPlaySound", true)
		end
	end 
	usermessage.Hook("FMOD_RadioTalker",FMOD_RadioTalker)
]]-- 

--[[ -- God, I genuinely hate how all the stuff is before before the "IsPlayer()". Also, I think this makes your hear your Npc's stuff over radio?
	hook.Add( "EntityEmitSound", "FMOD_RadioSoundsEdit", function( data )
		local ply = LocalPlayer()
		local name = data.SoundName
		local oname = data.OriginalSoundName
		local time = data.SoundTime
		local dsp = data.DSP
		local level = data.SoundLevel
		local pitch = data.Pitch
		local flags = data.Flags
		local channel = data.Channel
		local volume = data.Volume
		local ent = data.Entity
		local pos = data.Pos

		if ent:IsPlayer() and ent:GetNWBool("FMOD_AllowRadio") and ent:GetNWBool("FMOD_RadioPlaySound") and string.find( string.lower( data.SoundName ), "vo") then
			ent:SetNWBool("FMOD_RadioPlaySound", false)

			--ent:EmitSound("npc/metropolice/vo/on2.wav")
			local RadioE = CreateSound(ent, "npc/metropolice/vo/on2.wav")
			RadioE:PlayEx(1.0, 100)
			data.Flags = data.Flags + 1024
			data.Channel = CHAN_VOICE
			data.Volume = 0.5
			data.SoundLevel = 1
			data.Pitch = 90
			return true
		end
	end)
]]--


--[[ -- Halo's people that follow you. Don't *think* we need it, but it IS client side.
	hook.Add("PreDrawHalos", "FMOD_Halos", function()
	local ply = LocalPlayer()
	local FMOD_Followers = {}
	local FMOD_Spotted = {}
	if GetConVarNumber("fmod_halo") <= 0 then return end
	for _,ent in pairs(ents.GetAll()) do
	if ent and ent:GetNWBool("FMOD_ImAfterSomeone") and (!ent:GetNWBool("FMOD_InVehicle")) and ent:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() then
	if (ent:IsNPC() or ent:IsPlayer() or ent:GetClass()=="player") then
	if IsValid(ent:GetNetworkedEntity("FMOD_CustomModel")) then
	table.insert(FMOD_Followers,ent:GetNetworkedEntity("FMOD_CustomModel"))
	else
	table.insert(FMOD_Followers,ent)
	end
	else
	table.Empty(FMOD_Followers)
	end
	end
	
	if ent and ent:GetNWBool("FMOD_Spotted") then
	if GetConVarNumber("fmod_halo") <= 0 then return end
	if (ent:IsNPC() or ent:IsPlayer() or ent:GetClass()=="player") then
	table.insert(FMOD_Spotted,ent)
	else
	table.Empty(FMOD_Spotted)
	end
	end
	end
	if #FMOD_Followers >= 1 then halo.Add(FMOD_Followers, Color(GetConVarNumber("fmod_halocolor_r"), GetConVarNumber("fmod_halocolor_g"), GetConVarNumber("fmod_halocolor_b")), 2, 2, 5, true, true) end
	if #FMOD_Spotted >= 1 then halo.Add(FMOD_Spotted, Color(255, 0, 0), 2, 2, 5, true, true) end
	end)
]]--

	-- This is what's outputting the various messages into your chat.
	net.Receive("FMOD.Message", function()
		if GetConVarNumber("fmod_chat_support") > 0 then
			local ColorR = net.ReadFloat()
			local ColorG = net.ReadFloat()
			local ColorB = net.ReadFloat()
			local Text = net.ReadString()
			chat.AddText(Color(ColorR, ColorG, ColorB), Text)
		end
	end)
end
 
if(SERVER)then

	-- I swear litterally everyone just copies random code online without understanding what it does. Don't look at me like that.
--[[-- Toggles the radio for certain players. Don't think we want the radio.
	concommand.Add( "fmod_radio", function(ply,cmd,args,argStr)
		if (!ply:GetNWBool("FMOD_AllowRadio")) then
			ply:SetNWBool("FMOD_AllowRadio",true)
			ply:EmitSound("npc/metropolice/vo/on1.wav")

			net.Start("FMOD.Message")
			net.WriteFloat(0)
			net.WriteFloat(100)
			net.WriteFloat(255)
			net.WriteString("|FMod|: Radio Communication Enabled.")
			net.Send(ply)
		else
			ply:SetNWBool("FMOD_AllowRadio",false)
			ply:EmitSound("npc/metropolice/vo/off1.wav")

			net.Start("FMOD.Message")
				net.WriteFloat(0)
				net.WriteFloat(100)
				net.WriteFloat(255)
				net.WriteString("|FMod|: Radio Communication Disabled.")
			net.Send(ply)
		end
	end)
]]--

	-- This allows players to sit in your vehicles? Why is there a Check2? Who TF knows.
	-- This is a terribly written piece of garbage, but extremely inexpensive and good if rewritten.
	hook.Add("PlayerSpawnedVehicle", "FMOD_NPCsVehicles", function(ply, veh)
		if veh:GetClass() == "prop_vehicle_prisoner_pod" then
			local VModel = veh:GetModel()
			local check = veh:LookupAttachment("vehicle_feet_passenger0")
			local check2 = veh:GetAttachment(check)
			if check != 0 then
				if VModel == "models/nova/airboat_seat.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/nova/chair_office02.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/props_phx/carseat2.mdl" then
					veh.height = -19
					veh.forward = 8
				elseif VModel == "models/props_phx/carseat3.mdl" then
					veh.height = -20
					veh.forward = 29
				elseif VModel == "models/nova/chair_plastic01.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/nova/jalopy_seat.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/nova/jeep_seat.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/nova/chair_wood01.mdl" then
					veh.height = -19
					veh.forward = 0
				elseif VModel == "models/nova/chair_office01.mdl" then
					veh.height = -19
					veh.forward = 0
				else
					veh.height = 0
					veh.forward = 0
				end

				veh.npcvehskel = ents.Create("fmod_npc_vehicle")
				veh.att1 = veh:LookupAttachment("vehicle_feet_passenger0")
				veh.att2 = veh:GetAttachment(veh.att1)
				veh.npcvehskel:SetPos(veh.att2.Pos+veh:GetRight()*1+veh:GetForward()*veh.forward+veh:GetUp()*veh.height)
				veh.npcvehskel:SetAngles(veh.att2.Ang+Angle(0,-10,0))
				veh.npcvehskel:SetParent(veh)
				veh.npcvehskel:Spawn()
				veh.npcvehskel:Activate()
				veh.npcvehskel:SetNWEntity("FMOD_VehEntity", veh)
				veh:DeleteOnRemove(veh.npcvehskel)
			end
		end
	end)

	-- Makes the NPC no-targetable. This happens if you're crouching around with them. Not SURE we want it.
	local function NPCDoBeStealthy(npc)
		if !npc:IsFlagSet(65536) then
			npc:AddFlags(65536)
		end
		for _, other_npc in pairs(ents.GetAll()) do
			if other_npc:IsNPC() then
				if npc:Disposition(other_npc) == D_HT and !npc:GetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_HT") then
					npc:SetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_HT", true)
					npc:AddEntityRelationship(other_npc,D_LI,99)
				end
				if npc:Disposition(other_npc) == D_FR and !npc:GetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_FR") then
					npc:SetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_FR", true)
					npc:AddEntityRelationship(other_npc,D_LI,99)
				end
			end
		end
	end

	-- Cancels the above code.
	local function NPCDontBeStealthy(npc)
		if npc:IsFlagSet(65536) then
			npc:RemoveFlags(65536)
		end
		for _, other_npc in pairs(ents.GetAll()) do
			if other_npc:IsNPC() then
				if npc:GetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_HT") then
					npc:SetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_HT", false)
					npc:AddEntityRelationship(other_npc,D_HT,99)
				end
				if npc:GetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_FR") then
					npc:SetNWBool("EntDispositionToMe"..other_npc:EntIndex().."_FR", false)
					npc:AddEntityRelationship(other_npc,D_FR,99)
				end
			end
		end
	end

	-- Adds a follower. Were they extremely busy and couldn't just write "AddFollower"?
	-- In both of these, we might want to get rid of the Custom/Special stuff. Additonally, the logging
	-- to could be changed to "This person is now following you!" if we wanted. Useful for testing though.
	function AddFoll(ent, ply)
		ent:SetNWBool("FMOD_ImAfterSomeone", true)
		if ply then
			ent:SetNWString("FMOD_ImFollowing", ply:Nick()..ply:EntIndex())
			ent:SetNWEntity("FMOD_MyTarget", ply)
			ent:SetName(ply:Nick()..ply:EntIndex())
			ent:Fire("stoppatrolling","",0.5)
			ply:SetNWEntity("FMOD_MyFollower", ent)
			util.AddNetworkString("FMOD.Message")
			net.Start("FMOD.Message")
				net.WriteFloat(100)
				net.WriteFloat(255)
				net.WriteFloat(0)
				if ent:GetNWString("CustomName")!="" then
					net.WriteString("|FMod|: "..ent:GetNWString("CustomName").." has joined to Your squad.")
				else
					net.WriteString("|FMod|: "..ent:GetClass().." has joined to Your squad.")
				end
			net.Send(ply)
		end
		ent.FMODanimsTable = table.ToString(ent:GetSequenceList())
		ent:SetCustomCollisionCheck(true)
		-- Jump, Climb, Use things, open doors, open other doors, and can form squads.
		ent:CapabilitiesAdd(2)
		ent:CapabilitiesAdd(8)
		ent:CapabilitiesAdd(256)
		ent:CapabilitiesAdd(1024)
		ent:CapabilitiesAdd(2048)
		ent:CapabilitiesAdd(67108864)
		ent:Fire("setsquad","playersquad_"..ply:Nick()..ply:EntIndex(),0)
		ent:Fire("EnableArmorRecharge","",0)
	end

	-- Removes a Foll.
	function RemFoll(ent, ply)
		ent:SetNWBool("FMOD_ImAfterSomeone", false)
		ent:SetNWString("FMOD_ImFollowing", nil)
		ent:SetName("")
		if ply then
			ply:SetNWEntity("FMOD_MyFollower", nil)
			util.AddNetworkString("FMOD.Message")
			net.Start("FMOD.Message")
				net.WriteFloat(255)
				net.WriteFloat(100)
				net.WriteFloat(0)
				if ent:GetNWString("CustomName")!="" then
					net.WriteString("|FMod|: "..ent:GetNWString("CustomName").." has left Your squad.")
				else
					net.WriteString("|FMod|: "..ent:GetClass().." has left Your squad.")
				end
			net.Send(ply)
		end
		ent:SetNWEntity("FMOD_MyTarget", nil)
		ent:SetCustomCollisionCheck(false)
		ent:Fire("setsquad","",0)
		ent:Fire("DisableArmorRecharge","",0)
		NPCDontBeStealthy(ent)
		ent.CollisionBounds = Vector(13,13,72)
		local hull = ent:GetHullType()
		ent:SetSolid(SOLID_BBOX)
		ent:SetPos(ent:GetPos()+ent:GetUp()*6)
		ent:SetHullType(hull)
		ent:SetHullSizeNormal()
		ent:SetCollisionBounds(ent.CollisionBounds,Vector(ent.CollisionBounds.x *-1,ent.CollisionBounds.y *-1,0))
		ent:DropToFloor()
	end

	-- This has the follower respond to you. Seeing as we have droids/clones+civs as CP/citizens, how about we don't?
	function NPCFollRespond(ent)
		local class = ent:GetClass()
		if ent:GetNWString("FMOD_Custom_FollowMe") != "" then
			ent:EmitSound(ent:GetNWString("FMOD_Custom_FollowMe"))
		else
			if class == "npc_combine_s" then
				ent:EmitSound("FMod_FollowMe.CombineSoldier")
			elseif class == "npc_metropolice" then
				ent:EmitSound("FMod_FollowMe.Metropolice")
			elseif class == "npc_alyx" then
				print("kek")
				ent:EmitSound("FMod_FollowMe.Alyx")
			elseif class == "npc_barney" then
				ent:EmitSound("FMod_FollowMe.Barney")
			elseif class == "npc_citizen" then
				if string.find( string.lower( ent:GetModel() ), "female") then
					ent:EmitSound("FMod_FollowMe.CitizenFemale")
				else
					ent:EmitSound("FMod_FollowMe.CitizenMale")
				end
			elseif class == "npc_vortigaunt" then
				ent:EmitSound("FMod_FollowMe.Vort")
			elseif class == "npc_hunter" and ent:GetNWBool("FMOD_Huntey") then
				ent:EmitSound("FMod_FollowMe.Huntey")
			else
				ent:EmitSound("FMod_FollowMe.Other")
			end
		end
	end

	-- Different voice line.
	function NPCCopyRespond(ent)
		if ent:GetNWString("FMOD_Custom_Copy") != "" then
			ent:EmitSound(ent:GetNWString("FMOD_Custom_Copy"))
		else
			local class = ent:GetClass()
			if class == "npc_combine_s" then
				ent:EmitSound("FMod_Copy.CombineSoldier")
			elseif class == "npc_metropolice" then
				ent:EmitSound("FMod_Copy.Metropolice")
			elseif class == "npc_alyx" then
				ent:EmitSound("FMod_Copy.Alyx")
			elseif class == "npc_barney" then
				ent:EmitSound("FMod_Copy.Barney")
			elseif class == "npc_citizen" then
				if string.find( string.lower( ent:GetModel() ), "female") then
					ent:EmitSound("FMod_Copy.CitizenFemale")
				else
					ent:EmitSound("FMod_Copy.CitizenMale")
				end
			elseif class == "npc_vortigaunt" then
				ent:EmitSound("FMod_Copy.Vort")
			elseif class == "npc_hunter" and ent:GetNWBool("FMOD_Huntey") then
				ent:EmitSound("FMod_Copy.Huntey")
			else
				ent:EmitSound("FMod_Copy.Other")
			end
		end
	end

	-- Different voice line.
	function NPCStayRespond(ent)
		if ent:GetNWString("FMOD_Custom_StayHere") != "" then
			ent:EmitSound(ent:GetNWString("FMOD_Custom_StayHere"))
		else
			local class = ent:GetClass()
			if class == "npc_combine_s" then
				ent:EmitSound("FMod_StayHere.CombineSoldier")
			elseif class == "npc_metropolice" then
				ent:EmitSound("FMod_StayHere.Metropolice")
			elseif class == "npc_alyx" then
				ent:EmitSound("FMod_StayHere.Alyx")
			elseif class == "npc_barney" then
				ent:EmitSound("FMod_StayHere.Barney")
			elseif class == "npc_citizen" then
				if string.find( string.lower( ent:GetModel() ), "female") then
					ent:EmitSound("FMod_StayHere.CitizenFemale")
				else
					ent:EmitSound("FMod_StayHere.CitizenMale")
				end
			elseif class == "npc_vortigaunt" then
				ent:EmitSound("FMod_StayHere.Vort")
			elseif class == "npc_hunter" and ent:GetNWBool("FMOD_Huntey") then
				ent:EmitSound("FMod_StayHere.Huntey")
			else
			ent:EmitSound("FMod_StayHere.Other")
			end
		end
	end

	-- Where half the functionality is in the mod.
	-- We want to move this from a KeyPress to a SWEP.
	hook.Add("KeyPress", "FMOD_Select", function(ply, key)
		if GetConVarNumber("fmod_enable") > 0 then
			if (key == IN_USE || key == IN_RELOAD || key == IN_WALK) then return end

			local tr = ply:GetEyeTrace()
			local ent = ply:GetEyeTrace().Entity

			-- Adds follower.
			if (key == IN_USE) and IsValid(ent) and ent:IsNPC() and (ent:Disposition(ply) != D_HT and ent:Disposition(ply) != D_FR) and ply:GetPos():Distance(ent:GetPos()) <= GetConVarNumber("fmod_min_call_dist") and (!ent:GetNWBool("FMOD_ImAfterSomeone")) then
				AddFoll(ent, ply)
				if GetConVarNumber("fmod_followers_speak") > 0 then
					NPCFollRespond(ent)
				end
				if IsValid(ply.gfoll) then
					ply.gfoll:Fire("Deactivate", "", 0)
					ply.gfoll:Fire("Activate", "", 0.1)
				end

			-- Removes follower.
			elseif (key == IN_USE) and IsValid(ent) and ent:IsNPC() and ply:GetPos():Distance(ent:GetPos()) <= GetConVarNumber("fmod_min_call_dist") and ent:GetNWBool("FMOD_ImAfterSomeone") and (ent:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex()) then
				RemFoll(ent, ply)
				if GetConVarNumber("fmod_followers_speak") > 0 then
					NPCStayRespond(ent)
				end
			    if IsValid(ply.gfoll) then
					ply.gfoll:Fire("Deactivate", "", 0)
					ply.gfoll:Fire("Activate", "", 0.1)
				end
			end

			-- Majority of this code is about.
			-- Half of this isnt needed - 
			-- This code sends someone somewhere.
			if ply:KeyDown(IN_WALK) and (key == IN_RELOAD) and (!((IsValid(tr.Entity)) and (tr.Entity:IsNPC() or tr.Entity:IsWeapon() or tr.Entity:GetClass()=="item_healthkit" or tr.Entity:GetClass()=="item_healthvial"))) then
				for _,my_npc in pairs(ents.GetAll()) do
					if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") and my_npc:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() then
						my_npc:SetName("")
						my_npc:ClearEnemyMemory() 
						my_npc:Fire("stoppatrolling","",0.5)
						util.AddNetworkString("FMOD.Message")
						net.Start("FMOD.Message")
							net.WriteFloat(255)
							net.WriteFloat(255)
							net.WriteFloat(0)
							if my_npc:GetNWString("CustomName")!="" then
								net.WriteString("|FMod|: "..my_npc:GetNWString("CustomName").." take this position!")
							else
								net.WriteString("|FMod|: "..my_npc:GetClass().." take this position!")
							end
						net.Send(ply)
						my_npc:SetSaveValue("m_vecLastPosition", tr.HitPos)
						if IsValid(ply.gfoll) then ply.gfoll:Fire("Deactivate", "", 0) end
						my_npc:SetSchedule(SCHED_FORCED_GO_RUN)
						if GetConVarNumber("fmod_followers_speak") > 0 then
							NPCCopyRespond(my_npc)
						end
					end
				end

			-- This code makes them return to you.
			elseif ply:KeyDown(IN_RELOAD) and (key == IN_WALK) and (!((IsValid(tr.Entity)) and (tr.Entity:IsNPC() or tr.Entity:IsWeapon() or tr.Entity:GetClass()=="item_healthkit" or tr.Entity:GetClass()=="item_healthvial"))) then
				for _,my_npc in pairs(ents.GetAll()) do
					if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") and my_npc:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() then
						my_npc:SetName(my_npc:GetNWString("FMOD_ImFollowing"))
						my_npc:ClearEnemyMemory() 
						my_npc:Fire("stoppatrolling","",0.5)
						util.AddNetworkString("FMOD.Message")
						net.Start("FMOD.Message")
							net.WriteFloat(255)
							net.WriteFloat(255)
							net.WriteFloat(0)
							if my_npc:GetNWString("CustomName")!="" then
								net.WriteString("|FMod|: "..my_npc:GetNWString("CustomName").." follow me!")
							else
								net.WriteString("|FMod|: "..my_npc:GetClass().." follow me!")
							end
						net.Send(ply)
						if IsValid(ply.gfoll) then 
							ply.gfoll:Fire("Deactivate", "", 0)
							ply.gfoll:Fire("Activate", "", 0.1)
						end
						if GetConVarNumber("fmod_followers_speak") > 0 then
							NPCFollRespond(my_npc)
						end
					end
				end
			end

			-- This code keeps someone at one spot.
			if ply:KeyDown(IN_WALK) and (key == IN_RELOAD) and IsValid(tr.Entity) and tr.Entity:IsNPC() and tr.Entity:GetNWBool("FMOD_ImAfterSomeone") and tr.Entity:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() and tr.Entity:GetName() == ply:Nick()..ply:EntIndex() then
				tr.Entity:SetName("")
				tr.Entity:ClearEnemyMemory() 
				tr.Entity:Fire("stoppatrolling","",0.5) 
				util.AddNetworkString("FMOD.Message")
				net.Start("FMOD.Message")
					net.WriteFloat(255)
					net.WriteFloat(255)
					net.WriteFloat(0)
					if tr.Entity:GetNWString("CustomName")!="" then
						net.WriteString("|FMod|: "..tr.Entity:GetNWString("CustomName").." will hold this spot.")
					else
						net.WriteString("|FMod|: "..tr.Entity:GetClass().." will hold this spot.")
					end
				net.Send(ply)
				if GetConVarNumber("fmod_followers_speak") > 0 then
					NPCStayRespond(tr.Entity)
				end
				if IsValid(ply.gfoll) then
					ply.gfoll:Fire("Deactivate", "", 0)
					ply.gfoll:Fire("Activate", "", 0.1)
				end

			-- This code recalls someone.
			elseif ply:KeyDown(IN_WALK) and (key == IN_RELOAD) and IsValid(tr.Entity) and tr.Entity:IsNPC() and tr.Entity:GetNWBool("FMOD_ImAfterSomeone") and tr.Entity:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() and tr.Entity:GetName() != ply:Nick()..ply:EntIndex() then
				tr.Entity:SetName(tr.Entity:GetNWString("FMOD_ImFollowing"))
				tr.Entity:ClearEnemyMemory() 
				tr.Entity:Fire("stoppatrolling","",0.5)
				util.AddNetworkString("FMOD.Message")
				net.Start("FMOD.Message")
					net.WriteFloat(255)
					net.WriteFloat(255)
					net.WriteFloat(0)
					if tr.Entity:GetNWString("CustomName")!="" then
						net.WriteString("|FMod|: "..tr.Entity:GetNWString("CustomName").." will follow You now.")
					else
						net.WriteString("|FMod|: "..tr.Entity:GetClass().." will follow You now.")
					end
				net.Send(ply)
				if GetConVarNumber("fmod_followers_speak") > 0 then
					NPCFollRespond(tr.Entity)
				end
				if IsValid(ply.gfoll) then
					ply.gfoll:Fire("Deactivate", "", 0)
					ply.gfoll:Fire("Activate", "", 0.1)
				end
			end
		end
	end)

	-- I think this mainly just tests whether there is enough space to get up.
	local function SafeToGetUp(ent, ply, ent2) -- ent2?
		local tr = util.TraceHull
		{
			start = ent:GetPos(),
			endpos = ent:GetPos(),
			filter = {ent, ply},
			mins = Vector(-13, -13, 16),
			maxs = Vector(13, 13, 72)
		}
		if tr.Hit then return false else return true end
	end

	-- Checks if there is enough space around the target to teleport to them.
	local function SafeToTeleport(ent)
		local tr = util.TraceHull{
			start = ent:GetPos(),
			endpos = ent:GetPos(),
			filter = {ent},
			mins = Vector(-55, -55, 0),
			maxs = Vector(55, 55, 72)
		}
		if tr.Hit then return false else return true end
	end

	-- This isn't really great.
	-- Is this running through every NPC, for every player? Twice? What in the christmas candy fuck?
	hook.Add("SetupMove", "FMOD_SetUP", function(ply, mv, cmd)
		if GetConVarNumber("fmod_enable") > 0 then
			if (!IsValid(ply.gfoll)) and ply:Alive() then
				ply:SetName(ply:Nick())
				ply.gfoll = ents.Create("ai_goal_follow")
				ply.gfoll:SetPos(ply:GetPos())
				ply.gfoll:SetAngles(ply:GetAngles())
				ply.gfoll:SetKeyValue( "actor", ply:Nick()..ply:EntIndex() )
				ply.gfoll:SetKeyValue( "goal", ply:GetName() )
				ply.gfoll:SetKeyValue( "SearchType", "0" )
				ply.gfoll:SetKeyValue( "Formation", "0" )
				ply.gfoll:Fire("Deactivate", "", 0)
				ply.gfoll:Spawn()
				ply.gfoll:Activate()
			end

			-- If NPC's hate or fear you, remove them as followers.
			for _,my_npc in pairs(ents.GetAll()) do
				if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") and my_npc:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() and (my_npc:Disposition(ply) == D_HT or my_npc:Disposition(ply) == D_FR) then
					RemFoll(my_npc, ply)
				end
			end

			for _,my_npc in pairs(ents.GetAll()) do
				if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") then
					if my_npc.FMODanimsTable and my_npc:GetNWBool("FMOD_ImAfterSomeone") and string.find( string.lower( my_npc.FMODanimsTable ), "crouch_") and my_npc:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() then
						if (ply:KeyDown(IN_DUCK) or !SafeToGetUp(my_npc, ply)) and (!my_npc:GetNWBool("FMOD_InVehicle")) and (!my_npc:GetNWBool("FMOD_SpecialDown")) and ply:IsOnGround() and ply:WaterLevel() < 2 and ((!IsValid(my_npc:GetEnemy())) or (IsValid(my_npc:GetEnemy()) and (!my_npc:Visible(my_npc:GetEnemy())))) then
							if my_npc:GetMovementActivity() != ACT_WALK_CROUCH then
								my_npc:SetMovementActivity( ACT_WALK_CROUCH )
							end
							my_npc:SetNWBool("FMOD_Ducking", true)

							NPCDoBeStealthy(my_npc)

							if !my_npc:IsMoving() then
								if (!my_npc:GetNWBool("FMOD_DuckingAnim")) then
									if string.find( string.lower( my_npc.FMODanimsTable ), "stand_to_crouchpistol") then
										my_npc:PlayScene("scenes/fmod_duck_mp.vcd")
										my_npc.duckanimdelay = CurTime() + 0.6
									elseif string.find( string.lower( my_npc.FMODanimsTable ), "combat_stand_to_crouch") then
										my_npc:PlayScene("scenes/fmod_duck_cs.vcd")
										my_npc.duckanimdelay = CurTime() + 0.6
									else
										my_npc:PlayScene("scenes/fmod_duck.vcd")
										my_npc.duckanimdelay = CurTime() + 1
									end
									my_npc:SetNWBool("FMOD_DuckingAnim", true)
								else
									if my_npc.duckanimdelay != nil and (my_npc.duckanimdelay <= CurTime()) then
										my_npc.duckanimdelay = CurTime() + 0.1
										if string.find( string.lower( my_npc.FMODanimsTable ), "crouch_idle_pistol") then
											my_npc:PlayScene("scenes/fmod_duckloop_mp.vcd")
										elseif string.find( string.lower( my_npc.FMODanimsTable ), "crouch_aim_ar2") then
											my_npc:PlayScene("scenes/fmod_duckloop_cs.vcd")
										else
											my_npc:PlayScene("scenes/fmod_duckloop.vcd")
										end
									end
								end
							else
								my_npc:SetNWBool("FMOD_DuckingAnim", true)
							end

							if (!my_npc:GetNWBool("FMOD_DuckingFirst")) then
								my_npc:SetNWBool("FMOD_DuckingFirst", true)
								my_npc.CollisionBounds = Vector(13,13,72)
								local hull = my_npc:GetHullType()
								my_npc:SetSolid(SOLID_BBOX)
								my_npc:SetPos(my_npc:GetPos()+my_npc:GetUp()*6)
								my_npc:SetHullType(hull)
								my_npc:SetHullSizeNormal()
								my_npc:SetCollisionBounds(my_npc.CollisionBounds*0.5,Vector(my_npc.CollisionBounds.x *-1,my_npc.CollisionBounds.y *-1,0))
								my_npc:DropToFloor()
							end
						end
						if (!ply:KeyDown(IN_DUCK) and SafeToGetUp(my_npc, ply)) and (my_npc:GetNWBool("FMOD_Ducking")) then
							my_npc:StopMoving()

							NPCDontBeStealthy(my_npc)

							if !my_npc:IsMoving() then
								if string.find( string.lower( my_npc.FMODanimsTable ), "crouch_to_standpistol") then
									my_npc:PlayScene("scenes/fmod_standup_mp.vcd")
								elseif string.find( string.lower( my_npc.FMODanimsTable ), "crouch_to_combat_stand") then
									my_npc:PlayScene("scenes/fmod_standup_cs.vcd")
								else
									my_npc:PlayScene("scenes/fmod_standup.vcd")
								end
									my_npc:SetNWBool("FMOD_DuckingAnim", false)
							end

							my_npc.CollisionBounds = Vector(13,13,72)
							local hull = my_npc:GetHullType()
							my_npc:SetSolid(SOLID_BBOX)
							my_npc:SetPos(my_npc:GetPos()+my_npc:GetUp()*6)
							my_npc:SetHullType(hull)
							my_npc:SetHullSizeNormal()
							my_npc:SetCollisionBounds(my_npc.CollisionBounds,Vector(my_npc.CollisionBounds.x *-1,my_npc.CollisionBounds.y *-1,0))
							my_npc:DropToFloor()
							my_npc:SetNWBool("FMOD_Ducking", false)
							my_npc:SetNWBool("FMOD_DuckingFirst", false)
						end
					end
				end
				if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") and GetConVarNumber("fmod_auto_teleport") > 0 then
					if IsValid(my_npc:GetNWEntity("FMOD_MyTarget")) and (!my_npc:GetNWEntity("FMOD_MyTarget"):Visible(my_npc)) and SafeToTeleport(my_npc:GetNWEntity("FMOD_MyTarget")) and my_npc:GetNWEntity("FMOD_MyTarget"):IsOnGround() and my_npc:GetNWEntity("FMOD_MyTarget"):WaterLevel() < 2 and (my_npc:HasCondition(35)) and (!my_npc:HasCondition(49)) then
						my_npc:SetPos(my_npc:GetNWEntity("FMOD_MyTarget"):GetPos()+my_npc:GetNWEntity("FMOD_MyTarget"):GetForward()*-35+my_npc:GetNWEntity("FMOD_MyTarget"):GetUp()*6)
						my_npc:ClearEnemyMemory()
					end
				end
			end

			for _,enemy in pairs(ents.GetAll()) do
				if enemy and enemy:IsNPC() and (enemy:Disposition(ply) != D_LI and enemy:Disposition(ply) != D_NU) and ply:Visible(enemy) and IsValid(ply:GetNWEntity("FMOD_MyFollower")) and (!IsValid(ply:GetNWEntity("FMOD_MyFollower"):GetEnemy())) and (!ply:GetNWEntity("FMOD_MyFollower"):GetNWBool("FMOD_Ducking")) and GetConVarNumber("ai_disabled") <= 0 then
					ply:GetNWEntity("FMOD_MyFollower"):UpdateEnemyMemory(enemy, enemy:GetPos())
					if !ply:GetNWEntity("FMOD_MyFollower"):IsCurrentSchedule(SCHED_CHASE_ENEMY) then
						ply:GetNWEntity("FMOD_MyFollower"):SetSchedule(SCHED_CHASE_ENEMY)
					end
				end
			end
		end
	end)

	-- Removes npc's following you when you die.
	hook.Add("PlayerDeath", "FMOD_PlayerDeath", function(ply, weapon, killer)
		if IsValid(ply.gfoll) then SafeRemoveEntity(ply.gfoll) end
		for _,my_npc in pairs(ents.GetAll()) do
			if my_npc and my_npc:IsNPC() and my_npc:GetNWBool("FMOD_ImAfterSomeone") and my_npc:GetNWString("FMOD_ImFollowing") == ply:Nick()..ply:EntIndex() then
				RemFoll(my_npc, ply)
			end
		end
	end)

--[[-- I don't think we want to buff followers, or mess with friendly fire, or do anything with special npcs.
	hook.Add("EntityTakeDamage", "FMOD_AntiFFire", function(target, dmginfo)
		if GetConVarNumber("fmod_enable") > 0 then
			local attacker = dmginfo:GetAttacker()
			if GetConVarNumber("fmod_buff_followers") > 0 then
				if attacker:IsNPC() and attacker:GetNWBool("FMOD_ImAfterSomeone") then
					dmginfo:ScaleDamage(1 + GetConVarNumber("fmod_buff_damage"))
				end
				if target:IsNPC() and target:GetNWBool("FMOD_ImAfterSomeone") then
					dmginfo:ScaleDamage(1 - GetConVarNumber("fmod_buff_resistance")/10)
				end
			end
			if GetConVarNumber("fmod_allow_ff") <= 0 then
				if target:IsNPC() and (attacker:IsPlayer() or attacker:GetClass()=="player") and target:GetNWBool("FMOD_ImAfterSomeone") and (target:Disposition(attacker) != D_HT or target:Disposition(attacker) != D_FR) then
					dmginfo:ScaleDamage(0)
				end
				if attacker:IsNPC() and (target:IsPlayer() or target:GetClass()=="player") and attacker:GetNWBool("FMOD_ImAfterSomeone") and (attacker:Disposition(target) != D_HT or attacker:Disposition(target) != D_FR) then
					dmginfo:ScaleDamage(0)
				end
			end
			if attacker:IsNPC() and attacker:GetNWBool("FMOD_Special") and IsValid(attacker:GetNWEntity("FMOD_NPCBase")) then
				dmginfo:SetAttacker(attacker:GetNWEntity("FMOD_NPCBase"))
			end
		end
	end)
]]--

--hook.Add( "ShouldCollide", "FMOD_Collide", function(ent1, ent2)
--if GetConVarNumber("fmod_allow_collisions") <= 0 and ent1:IsNPC() and ent1:GetNWBool("FMOD_ImAfterSomeone") and (ent2:IsPlayer() or ent2:GetClass()=="player") and (ent1:Disposition(ent2) != D_HT or ent1:Disposition(ent2) != D_FR) then
--return false
--end
--end)

-- Most likely an unndeeded hook for MVG's reasons.
--[[
	hook.Add("EntityFireBullets", "FMOD_Accuracy", function(npc, data)
		if npc:GetNWBool("FMOD_ImAfterSomeone") and npc:GetCurrentWeaponProficiency() != GetConVarNumber("fmod_buff_proficiency") then
			npc:SetCurrentWeaponProficiency(GetConVarNumber("fmod_buff_proficiency"))
		end
	end)
]]--

-- Un-Halos npcs that die. Crazy that this wasn't commented out by default, and the halo was.
--[[
	hook.Add("OnNPCKilled", "FMOD_RemoveHalo", function(npc, killer, weapon)
		if npc:GetNWBool("FMOD_Special") and IsValid(npc:GetNetworkedEntity("FMOD_CustomModel")) then
			local model = npc:GetNetworkedEntity("FMOD_CustomModel")
			npc:SetModel(model:GetModel())
			npc:SetMaterial(model:GetMaterials())
			npc:SetColor(model:GetColor())
			npc:SetBodygroup(1,model:GetBodygroup(1))
			npc:SetBodygroup(2,model:GetBodygroup(2))
			npc:SetBodygroup(3,model:GetBodygroup(3))
			npc:SetBodygroup(4,model:GetBodygroup(4))
			npc:SetBodygroup(5,model:GetBodygroup(5))
			npc:SetBodygroup(6,model:GetBodygroup(6))
			npc:SetBodygroup(7,model:GetBodygroup(7))
			npc:SetBodygroup(8,model:GetBodygroup(8))
			npc:SetBodygroup(9,model:GetBodygroup(9))
			npc:DrawShadow(true)
			npc:SetNoDraw(false)
			npc:SetRenderMode(RENDERMODE_TRANSCOLOR)
			npc:SetColor(Color(255,255,255,255))
			SafeRemoveEntity(npc:GetNetworkedEntity("FMOD_CustomModel"))
		end
		if npc:GetNWBool("FMOD_Special") and IsValid(npc:GetNWEntity("FMOD_Light")) then
			SafeRemoveEntity(npc:GetNWEntity("FMOD_Light"))
		end
		if npc:GetNWBool("FMOD_ImAfterSomeone") then
			util.AddNetworkString("FMOD.Message")
			net.Start("FMOD.Message")
				net.WriteFloat(255)
				net.WriteFloat(50)
				net.WriteFloat(0)
				if IsValid(killer) then
					if killer:IsPlayer() then
						if npc:GetNWString("CustomName")!="" then
							net.WriteString("|FMod|: ".."Your follower "..npc:GetNWString("CustomName").." has been killed by "..killer:Nick()..".")
						else
							net.WriteString("|FMod|: ".."Your follower "..npc:GetClass().." has been killed by "..killer:Nick()..".")
						end
					else
						if npc:GetNWString("CustomName")!="" then
							net.WriteString("|FMod|: ".."Your follower "..npc:GetNWString("CustomName").." has been killed by "..killer:GetClass()..".")
						else
							net.WriteString("|FMod|: ".."Your follower "..npc:GetClass().." has been killed by "..killer:GetClass()..".")
						end
					end
				else
					if npc:GetNWString("CustomName")!="" then
						net.WriteString("|FMod|: ".."Your follower "..npc:GetNWString("CustomName").." died.")
					else
						net.WriteString("|FMod|: ".."Your follower "..npc:GetName().." died.")
					end
				end
			net.Send(npc:GetNWEntity("FMOD_MyTarget"))
			RemFoll(npc)
		end
	end)

---- Special Npc STUFF - Not going to kill it off, because it looks vaguely useful. ----

--[[
	hook.Add("EntityTakeDamage", "FMOD_SpecialAntiDeath", function(target, dmginfo)
		local attacker = dmginfo:GetAttacker()
		if target:GetNWBool("FMOD_Special") and target:GetNWBool("FMOD_Mortal") and dmginfo:GetDamage() >= target:Health() and GetConVarNumber("fmod_followers_special_mortal") > 0 then
			target:ClearCondition(67)
			target:SetCondition(68)
		end
		if target:GetNWBool("FMOD_Special") and target:Health() >= 0 and dmginfo:GetDamage() >= target:Health() then
			if target:GetNWBool("FMOD_Mortal") and GetConVarNumber("fmod_followers_special_mortal") > 0 then return end
			dmginfo:ScaleDamage(0)
			target:SetHealth(10)
			if !target:IsFlagSet(65536) then target:AddFlags(65536) end
			target:ClearCondition(68)
			target:SetCondition(67)
			target:SetNWBool("FMOD_SpecialDown", true)
			target:SetSchedule(SCHED_NPC_FREEZE)
		end
	end)

	hook.Add( "EntityEmitSound", "FMOD_SpecialSounds", function( data )
		local name = data.SoundName
		local oname = data.OriginalSoundName
		local time = data.SoundTime
		local dsp = data.DSP
		local level = data.SoundLevel
		local pitch = data.Pitch
		local flags = data.Flags
		local channel = data.Channel
		local volume = data.Volume
		local ent = data.Entity
		local pos = data.Pos

		if ent:GetNWBool("FMOD_Huntey") and string.find( string.lower( data.SoundName ), "ministrider") then
			data.Pitch = 150
			return true
		end

		if ent:GetNWBool("FMOD_Delta") and string.find( string.lower( data.SoundName ), "vo/npc") then
			data.SoundLevel = 70
			data.Pitch = 90
			data.Volume = 0.7
			if IsValid(ent:GetNWEntity("FMOD_MyTarget")) then
				umsg.Start("FMOD_RadioTalker")
					umsg.String(data.SoundName)
					umsg.Entity(ent:GetNWEntity("FMOD_MyTarget"))
					umsg.Float(data.SoundLevel)
					umsg.Float(data.Pitch)
					umsg.Float(data.Volume)
				umsg.End()
			end
			return true
		end
		if ent:GetNWBool("FMOD_Stevetb") and string.find( string.lower( data.SoundName ), "vo/npc") and string.find( string.lower( data.OriginalSoundName ), "citizen") then
			if
				string.find( string.lower( data.SoundName ), "pain") or
				string.find( string.lower( data.SoundName ), "ow") or
				string.find( string.lower( data.SoundName ), "imhurt") or
				string.find( string.lower( data.SoundName ), "moan") or
				string.find( string.lower( data.SoundName ), "leg") or
				string.find( string.lower( data.SoundName ), "arm") or
				string.find( string.lower( data.SoundName ), "gut")
			then
				if math.random(1,2) == 2 then
					data.SoundName = "fmod_steve_the_bandit/steve_heyo7.wav"
				else
					data.SoundName = "fmod_steve_the_bandit/steve_heyo9.wav"
				end
			else
				data.SoundName = "fmod_steve_the_bandit/steve_heyo1.wav"
			end
			data.Channel = CHAN_VOICE
			data.Volume = 1.0
			data.SoundLevel = SNDLVL_80dB
			data.Pitch = PITCH_NORM
			return true
		end
	end)
]]
end

-- These are some of the example "special" npcs.
--if ( IsMounted( "ep2" ) ) then
--Your little friend.
--[[
local NPC = { 	Name = "Huntey", 
				Class = "fmod_huntey",
				Category = Category	}

list.Set( "NPC", NPC.Class, NPC )

local NPC = { 	Name = "Delta", 
				Class = "fmod_delta",
				Category = Category	}

list.Set( "NPC", NPC.Class, NPC )

local NPC = { 	Name = "Steve the Bandit", 
				Class = "fmod_steve_the_bandit",
				Category = Category	}

list.Set( "NPC", NPC.Class, NPC )]]